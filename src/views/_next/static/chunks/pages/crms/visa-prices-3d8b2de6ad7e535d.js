(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[683],{21317:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/visa-prices",function(){return s(71326)}])},71326:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return R}});var i=s(85893),a=s(67294),l=s(79072),n=s(49837),t=s(59742),c=s(61953),o=s(29630),d=s(91359),x=s(18661),p=s(45670),h=s(8769),m=s(55050),u=s(94314),j=s(5464),Z=s(80562),v=s(73812),y=s(31538),g=s(67836),f=s(75084),C=s(1890),b=s(77745),T=s(95398),P=s(55343),S=s(58316),W=s(53442),w=s(32631),_=s(40818),z=s(21609),k=s(74231),I=s(47533),V=s(87536),q=s(86501);let B=e=>{let{id:r,editPrice:s,deletePrice:l}=e,[n,t]=(0,a.useState)(null),c=Boolean(n),o=e=>{t(e.currentTarget)},d=()=>{t(null)},x=()=>{s(r),d()},p=()=>{l(r),d()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.Z,{size:"small",onClick:o,children:(0,i.jsx)(z.Z,{icon:"mdi:dots-vertical"})}),(0,i.jsxs)(v.Z,{keepMounted:!0,anchorEl:n,open:c,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(y.Z,{onClick:x,sx:{"& svg":{mr:2}},children:[(0,i.jsx)(z.Z,{icon:"mdi:pencil-outline",fontSize:20}),"Edit"]}),(0,i.jsxs)(y.Z,{onClick:p,sx:{"& svg":{mr:2}},children:[(0,i.jsx)(z.Z,{icon:"mdi:delete-outline",fontSize:20}),"Delete"]})]})]})},E=e=>{let{visaTypes:r}=e,[s,l]=(0,a.useState)(!0),[n,t]=(0,a.useState)(""),[d,x]=(0,a.useState)(10),[p,h]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),[v,E]=(0,a.useState)(!1),[N,O]=(0,a.useState)(0),Q={visaType:"",price:0},R=k.Ry().shape({visaType:k.Z_().required("Visa type is required field."),price:k.Rx("Price must be numeric").required("Price is required field.")}),{reset:F,control:X,handleSubmit:M,formState:{errors:A}}=(0,V.cI)({defaultValues:Q,mode:"onChange",resolver:(0,I.X)(R)}),{reset:D,control:H,handleSubmit:G,formState:{errors:U}}=(0,V.cI)({defaultValues:Q,mode:"onChange",resolver:(0,I.X)(R)});(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await j.Z.get("crms/visa-prices",{params:{search:n}});h(e)};e()},[s,n,d]);let L=()=>{F({visaType:r[0]._id,price:0}),u(!0)},J=async e=>{let{data:r}=await j.Z.post("crms/visa-prices",e);r.status?(F(Q),u(!1),l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)},K=async e=>{O(e);let{data:r}=await j.Z.get("crms/visa-prices/".concat(e));D({visaType:r.visaType,price:r.price}),E(!0)},Y=async e=>{let{data:r}=await j.Z.put("crms/visa-prices/".concat(N),e);r.status?(D(Q),E(!1),l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)},$=async e=>{let{data:r}=await j.Z.delete("crms/visa-prices/".concat(e));r.status?(l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)};return(0,i.jsxs)(c.Z,{children:[(0,i.jsx)(c.Z,{sx:{pl:0,pr:0,pt:0,pb:0,display:"flex",flex:1,flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end"},children:(0,i.jsxs)(c.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,i.jsx)(g.Z,{size:"small",value:n,sx:{mr:6,mb:2},placeholder:"Search visa...",onChange:e=>t(e.target.value)}),(0,i.jsxs)(f.Z,{sx:{mb:2},onClick:L,variant:"contained",children:[(0,i.jsx)(z.Z,{icon:"mdi:plus"})," Add Price"]})]})}),(0,i.jsx)(_._,{autoHeight:!0,getRowId:e=>e._id,rows:p,columns:[{flex:.7,minWidth:230,field:"visaType",headerName:"Visa Price",renderCell(e){let{row:r}=e;return(0,i.jsx)(o.Z,{noWrap:!0,children:r.visa[0].name})}},{flex:.7,minWidth:250,field:"price",headerName:"Price",renderCell(e){let{row:r}=e;return(0,i.jsxs)(o.Z,{noWrap:!0,children:["\xa3",r.price]})}},{flex:.1,width:80,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:r}=e;return(0,i.jsx)(B,{id:r._id,editPrice:K,deletePrice:$})}}],pageSize:d,sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onPageSizeChange:e=>x(e)}),(0,i.jsxs)(C.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>u(!1),open:m,children:[(0,i.jsxs)(b.Z,{children:["New Price",(0,i.jsx)(Z.Z,{onClick:()=>u(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,i.jsx)(z.Z,{icon:"mdi:close"})})]}),(0,i.jsx)(T.Z,{sx:{p:6},children:(0,i.jsxs)("form",{onSubmit:M(J),style:{paddingTop:8},children:[(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(S.Z,{id:"visa-type",error:Boolean(A.visaType),htmlFor:"visa-type",children:"Visa Type"}),(0,i.jsx)(V.Qr,{id:"visa-type",name:"visaType",control:X,rules:{required:!0},render(e){let{field:{value:s,onChange:a}}=e;return(0,i.jsx)(W.Z,{value:s,label:"Visa Type",onChange:a,error:Boolean(A.visaType),children:r.map((e,r)=>(0,i.jsx)(y.Z,{value:e._id,children:e.name},r))})}}),A.visaType&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:A.visaType.message})]}),(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(V.Qr,{name:"price",control:X,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,i.jsx)(g.Z,{value:r,label:"Visa Price",onChange:s,placeholder:"100",error:Boolean(A.price)})}}),A.price&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:A.price.message})]}),(0,i.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,i.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Save"}),(0,i.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:delete"}),onClick:()=>u(!1),children:"Cancel"})]})]})})]}),(0,i.jsxs)(C.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>E(!1),open:v,children:[(0,i.jsxs)(b.Z,{children:["Edit Price",(0,i.jsx)(Z.Z,{onClick:()=>E(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,i.jsx)(z.Z,{icon:"mdi:close"})})]}),(0,i.jsx)(T.Z,{sx:{p:6},children:(0,i.jsxs)("form",{onSubmit:G(Y),style:{paddingTop:8},children:[(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(S.Z,{id:"visa-type",error:Boolean(U.visaType),htmlFor:"visa-type",children:"Visa Type"}),(0,i.jsx)(V.Qr,{id:"visa-type",name:"visaType",control:H,rules:{required:!0},render(e){let{field:{value:s,onChange:a}}=e;return(0,i.jsx)(W.Z,{readOnly:!0,value:s,label:"Visa Type",onChange:a,error:Boolean(U.visaType),children:r.map((e,r)=>(0,i.jsx)(y.Z,{value:e._id,children:e.name},r))})}}),U.visaType&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:U.visaType.message})]}),(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(V.Qr,{name:"price",control:H,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,i.jsx)(g.Z,{value:r,label:"Visa Price",onChange:s,placeholder:"100",error:Boolean(U.price)})}}),U.price&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:U.price.message})]}),(0,i.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,i.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Update"}),(0,i.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:delete"}),onClick:()=>E(!1),children:"Cancel"})]})]})})]})]})},N=e=>{let{id:r,editPrice:s,deletePrice:l}=e,[n,t]=(0,a.useState)(null),c=Boolean(n),o=e=>{t(e.currentTarget)},d=()=>{t(null)},x=()=>{s(r),d()},p=()=>{l(r),d()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.Z,{size:"small",onClick:o,children:(0,i.jsx)(z.Z,{icon:"mdi:dots-vertical"})}),(0,i.jsxs)(v.Z,{keepMounted:!0,anchorEl:n,open:c,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(y.Z,{onClick:x,sx:{"& svg":{mr:2}},children:[(0,i.jsx)(z.Z,{icon:"mdi:pencil-outline",fontSize:20}),"Edit"]}),(0,i.jsxs)(y.Z,{onClick:p,sx:{"& svg":{mr:2}},children:[(0,i.jsx)(z.Z,{icon:"mdi:delete-outline",fontSize:20}),"Delete"]})]})]})},O=e=>{let{visaTypes:r}=e,[s,l]=(0,a.useState)(!0),[n,t]=(0,a.useState)(""),[d,x]=(0,a.useState)(10),[p,h]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),[v,B]=(0,a.useState)(!1),[E,O]=(0,a.useState)(0),Q={visaType:"",price:0},R=k.Ry().shape({visaType:k.Z_().required("Visa type is required field."),price:k.Rx("Price must be numeric").required("Price is required field.")}),{reset:F,control:X,handleSubmit:M,formState:{errors:A}}=(0,V.cI)({defaultValues:Q,mode:"onChange",resolver:(0,I.X)(R)}),{reset:D,control:H,handleSubmit:G,formState:{errors:U}}=(0,V.cI)({defaultValues:Q,mode:"onChange",resolver:(0,I.X)(R)});(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await j.Z.get("crms/agent-visa-prices",{params:{search:n}});h(e)};e()},[s,n,d]);let L=()=>{F({visaType:r[0]._id,price:0}),u(!0)},J=async e=>{let{data:r}=await j.Z.post("crms/agent-visa-prices",e);r.status?(F(Q),u(!1),l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)},K=async e=>{O(e);let{data:r}=await j.Z.get("crms/agent-visa-prices/".concat(e));D({visaType:r.visaType,price:r.price}),B(!0)},Y=async e=>{let{data:r}=await j.Z.put("crms/agent-visa-prices/".concat(E),e);r.status?(D(Q),B(!1),l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)},$=async e=>{let{data:r}=await j.Z.delete("crms/agent-visa-prices/".concat(e));r.status?(l(!s),q.ZP.success(r.msg)):q.ZP.error(r.msg)};return(0,i.jsxs)(c.Z,{children:[(0,i.jsx)(c.Z,{sx:{pl:0,pr:0,pt:0,pb:0,display:"flex",flex:1,flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end"},children:(0,i.jsxs)(c.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,i.jsx)(g.Z,{size:"small",value:n,sx:{mr:6,mb:2},placeholder:"Search visa...",onChange:e=>t(e.target.value)}),(0,i.jsxs)(f.Z,{sx:{mb:2},onClick:L,variant:"contained",children:[(0,i.jsx)(z.Z,{icon:"mdi:plus"})," Add Price"]})]})}),(0,i.jsx)(_._,{autoHeight:!0,getRowId:e=>e._id,rows:p,columns:[{flex:.7,minWidth:230,field:"visaType",headerName:"Visa Price",renderCell(e){let{row:r}=e;return(0,i.jsx)(o.Z,{noWrap:!0,children:r.visa[0].name})}},{flex:.7,minWidth:250,field:"price",headerName:"Price",renderCell(e){let{row:r}=e;return(0,i.jsxs)(o.Z,{noWrap:!0,children:["\xa3",r.price]})}},{flex:.1,width:80,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:r}=e;return(0,i.jsx)(N,{id:r._id,editPrice:K,deletePrice:$})}}],pageSize:d,sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onPageSizeChange:e=>x(e)}),(0,i.jsxs)(C.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>u(!1),open:m,children:[(0,i.jsxs)(b.Z,{children:["New Price",(0,i.jsx)(Z.Z,{onClick:()=>u(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,i.jsx)(z.Z,{icon:"mdi:close"})})]}),(0,i.jsx)(T.Z,{sx:{p:6},children:(0,i.jsxs)("form",{onSubmit:M(J),style:{paddingTop:8},children:[(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(S.Z,{id:"visa-type",error:Boolean(A.visaType),htmlFor:"visa-type",children:"Visa Type"}),(0,i.jsx)(V.Qr,{id:"visa-type",name:"visaType",control:X,rules:{required:!0},render(e){let{field:{value:s,onChange:a}}=e;return(0,i.jsx)(W.Z,{value:s,label:"Visa Type",onChange:a,error:Boolean(A.visaType),children:r.map((e,r)=>(0,i.jsx)(y.Z,{value:e._id,children:e.name},r))})}}),A.visaType&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:A.visaType.message})]}),(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(V.Qr,{name:"price",control:X,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,i.jsx)(g.Z,{value:r,label:"Visa Price",onChange:s,placeholder:"100",error:Boolean(A.price)})}}),A.price&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:A.price.message})]}),(0,i.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,i.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Save"}),(0,i.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:delete"}),onClick:()=>u(!1),children:"Cancel"})]})]})})]}),(0,i.jsxs)(C.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>B(!1),open:v,children:[(0,i.jsxs)(b.Z,{children:["Edit Price",(0,i.jsx)(Z.Z,{onClick:()=>B(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,i.jsx)(z.Z,{icon:"mdi:close"})})]}),(0,i.jsx)(T.Z,{sx:{p:6},children:(0,i.jsxs)("form",{onSubmit:G(Y),style:{paddingTop:8},children:[(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(S.Z,{id:"visa-type",error:Boolean(U.visaType),htmlFor:"visa-type",children:"Visa Type"}),(0,i.jsx)(V.Qr,{id:"visa-type",name:"visaType",control:H,rules:{required:!0},render(e){let{field:{value:s,onChange:a}}=e;return(0,i.jsx)(W.Z,{readOnly:!0,value:s,label:"Visa Type",onChange:a,error:Boolean(U.visaType),children:r.map((e,r)=>(0,i.jsx)(y.Z,{value:e._id,children:e.name},r))})}}),U.visaType&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:U.visaType.message})]}),(0,i.jsxs)(P.Z,{fullWidth:!0,sx:{mb:6},children:[(0,i.jsx)(V.Qr,{name:"price",control:H,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,i.jsx)(g.Z,{value:r,label:"Visa Price",onChange:s,placeholder:"100",error:Boolean(U.price)})}}),U.price&&(0,i.jsx)(w.Z,{sx:{color:"error.main"},children:U.price.message})]}),(0,i.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,i.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Update"}),(0,i.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,i.jsx)(z.Z,{icon:"mdi:delete"}),onClick:()=>B(!1),children:"Cancel"})]})]})})]})]})},Q=()=>{let[e,r]=(0,a.useState)("1"),[s,u]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await j.Z.get("crms/visa-types");u(e)};e()},[]);let Z=(e,s)=>{r(s)};return(0,i.jsx)(l.ZP,{container:!0,spacing:6,children:(0,i.jsx)(l.ZP,{item:!0,xs:12,children:(0,i.jsxs)(n.Z,{children:[(0,i.jsx)(t.Z,{title:(0,i.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(o.Z,{variant:"h5",children:"Visa Prices Management"})})}),(0,i.jsx)(d.Z,{children:(0,i.jsxs)(p.ZP,{value:e,children:[(0,i.jsxs)(h.Z,{variant:"fullWidth",onChange:Z,children:[(0,i.jsx)(x.Z,{value:"1",label:"Prices for global user"}),(0,i.jsx)(x.Z,{value:"2",label:"Prices for agent"})]}),(0,i.jsx)(m.Z,{value:"1",children:(0,i.jsx)(E,{visaTypes:s})}),(0,i.jsx)(m.Z,{value:"2",children:(0,i.jsx)(O,{visaTypes:s})})]})})]})})})};Q.getLayout=e=>(0,i.jsx)(u.Z,{children:e});var R=Q}},function(e){e.O(0,[284,480,710,267,72,871,330,323,169,733,459,1,297,314,774,888,179],function(){return e(e.s=21317)}),_N_E=e.O()}]);